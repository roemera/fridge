<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Fridge</title>

        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="https://api.trello.com/1/client.js?key=8d33be7a0ea6f6294339895ba802b978"></script>

        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

        <!-- Optional theme -->
        <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

        <!-- Latest compiled and minified JavaScript -->
        <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

        <style>
            body {
                padding-top: 40px;
                padding-bottom: 40px;
                background-color: #eee;
            }

            .col-centered {
                float: none;
                margin: 0 auto;
                text-align: center;
            }
            .list-entry{
                min-width: 500px;
            }

        </style>
    </head>
    <body>
        <a href="https://trello.com/1/authorize?key=8d33be7a0ea6f6294339895ba802b978&name=Fridge&expiration=never&response_type=token&scope=read,write"
                >Get Token
        </a>

        <input class="token-entry">
        <a class="token-save">Set Token</a>


        <div class="container">

            <div class="row">
                <div class="col-lg-12 col-centered">

                <br><br><br><br><br><br>
                <form class="form-inline form-signin" role="form">
                    <div class="form-group">
                        <select class="select-checklist form-control input-lg"></select>
                    </div>
                    <div class="form-group">
                        <input type="input" class="form-control input-lg list-entry" id="exampleInputEmail2" placeholder="Add Checklist Item...">
                    </div>
                    <button type="button" class="btn btn-default btn-lg list-save">Add</button>
                </form>

            </div>
        </div>

        </div>
        <!-- /container -->


        <script>

            $(".token-save").click(function () {
                localStorage.setItem("token", $(".token-entry").val());
            });

            $(".list-save").click(function () {
                $.ajax({
                    url: "https://api.trello.com/1/checklists/" + $(".select-checklist").val() + "/checkItems",
                    data: {
                        key: "8d33be7a0ea6f6294339895ba802b978",
                        token: localStorage.getItem("token"),
                        name: $(".list-entry").val()
                    },
                    success: function () {
                        $(".list-entry").val("").focus();

                    },
                    type: "POST"
                });
            });

            $.ajax({
                success: function (data) {
                    $.each(data, function (i, v) {
                        if (!v.closed) {
                            $.ajax({
                                success: function (data) {
                                    $.each(data, function (i, v) {
                                        var item = $("<option></option>");
                                        item.html(v.name);
                                        item.attr("value", v.id);
                                        $(".select-checklist").append(item);
                                    });
                                },
                                url: "https://api.trello.com/1/boards/" + v.id + "/checklists",
                                data: {
                                    key: "8d33be7a0ea6f6294339895ba802b978",
                                    token: localStorage.getItem("token")
                                },
                                dataType: "jsonp"
                            });
                        }
                    });
                },
                url: "https://api.trello.com/1/members/me/boards",
                data: {
                    key: "8d33be7a0ea6f6294339895ba802b978",
                    token: localStorage.getItem("token")
                },
                dataType: "jsonp"
            });


        </script>

    </body>
</html>